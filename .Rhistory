dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire!="mare_comblee" & Commentaire!="mare_seche" & Commentaire=="mare_seche_ou_pas_trouvee")
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire!="mare_comblee" & Commentaire!="mare_seche" & Commentaire!="mare_seche_ou_pas_trouvee")
View(dat2)
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee") %>%
filter(Commentaire != "mare_seche")
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond)
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee" & is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" & is.na(Commentaire))
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" | is.na(Commentaire))
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche_ou_pas_trouvee" | is.na(Commentaire))
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche_ou_pas_trouvee" | is.na(Commentaire)) %>%
filter(!is.na(Forme))
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Commentaire = commentaire,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond) %>%
filter(Commentaire != "mare_comblee" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche_ou_pas_trouvee" | is.na(Commentaire)) %>%
filter(!is.na(Forme)) %>%
filter(!is.na(Longueur))
dat2
dat2 <- dat %>%
add_column(ID = id.numbers) %>%
select(ID,
Type = type,
Forme = forme,
Longueur,
Largeur = largeur,
Contexte = contexte_1,
Topo = topo,
Liaison_Hydro = liaison_reseau,
Alim_Spe = alim_specifique,
Regime = regime,
Turbidite = turbidite,
Profondeur = profondeur,
Berges = berges,
Pietinement = pietinement,
Boisement = boisement,
Ombrage = ombrage,
Helophytes = helophytes,
Hydrophytes_Enr = hydrophytes_enracines,
Hydrophytes_NEnr = hydrophytes_non_enracines,
Algues = algues,
Fond_Ex = fond_exonde,
Eau_Libre = eau_libre,
Evolution = evolution,
Poissons = poisson,
Amphibiens = amphibien,
Odonates = odonate,
Invasives = presence_flore_exotique,
Fond = nature_fond,
Commentaire = commentaire) %>%
filter(Commentaire != "mare_comblee" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche" | is.na(Commentaire)) %>%
filter(Commentaire != "mare_seche_ou_pas_trouvee" | is.na(Commentaire)) %>%
filter(!is.na(Forme)) %>%
filter(!is.na(Longueur))
dat2
dat2 %>%
group_by(Type, Forme, Contexte) %>%
summarize(count = n())
dat2 %>%
group_by(Type, Forme) %>%
summarize(count = n())
dat2 %>%
group_by(Type) %>%
summarize(count = n())
dat2 %>%
group_by(Contexte) %>%
summarize(count = n())
ggplot(dat2, aes(x = Contexte, y = Largeur*Longueur)) + geom_point()
ggplot(dat2, aes(x = Largeur, y = Longueur)) + geom_point()
dat2
ggplot(dat2, aes(x = Contexte, y = Longueur*Largeur)) + geom_boxplot()
ggplot(dat2, aes(x = Contexte, y = sqrt(Longueur*Largeur))) + geom_boxplot()
library(ade4)
ggplot(dat2, aes(x = Contexte, y = Eau_Libre)) + geom_boxplot()
ggplot(dat2, aes(x = Contexte)) + geom_bar(aes(y = Eau_Libre))
ggplot(dat2, aes(x = Contexte)) + geom_bar(aes(y = Eau_Libre), stat = "identity")
ggplot(dat2, aes(x = Contexte)) + geom_bar(aes(y = c(Eau_Libre, Fond_Ex)), stat = "identity")
ggplot(dat2, aes(x = Contexte)) + geom_bar(aes(y = Fond_Ex), stat = "identity")
rec <- dat2 %>%
select(Contexte,
Evolution,
Profondeur,
Topo,
Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre)
rec
?gather
rec2 <- rec %>%
gather(Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre,
key = "Vegetation",
value = "Couvrement")
rec2
ggplot(rec2) + geom_bar(aes(x = Contexte, y = Couvrement), stat = "identity", position = "stack")
ggplot(rec2) + geom_bar(aes(x = Contexte, y = Couvrement, fill = Vegetation), stat = "identity", position = "stack")
ggplot(rec2) + geom_bar(aes(x = Contexte, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
View(rec2)
filter(rec2, Contexte=="bas_marais_tourbiere_alcaline")
filter(rec, Contexte=="bas_marais_tourbiere_alcaline")
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
?fct_relevel
rec2$Vegetation
rec2
rec2 <- rec %>%
gather(Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre,
key = "Vegetation",
value = "Couvrement") %>%
mutate(
Vegetation = as.factor(Vegetation)
)
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
Vegetation = fct_relevel(as.factor(Vegetation), c("Fond_Ex", "Eau_Libre", "Algues", "Hydrophytes_NEnr", "Hydrophytes_Enr", "Helophytes")
)
rec2
rec2 <- rec2 %>%
mutate(
Vegetation = fct_relevel(as.factor(Vegetation), c("Fond_Ex", "Eau_Libre", "Algues", "Hydrophytes_NEnr", "Hydrophytes_Enr", "Helophytes")
)
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
rec2 <- rec2 %>%
mutate(
Vegetation = fct_relevel(as.factor(Vegetation), c("Fond_Ex", "Eau_Libre", "Algues", "Hydrophytes_NEnr", "Hydrophytes_Enr", "Helophytes"))
)
rec2 <- rec %>%
gather(Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre,
key = "Vegetation",
value = "Couvrement")
rec2 <- rec2 %>%
mutate(
Vegetation = fct_relevel(as.factor(Vegetation), c("Fond_Ex", "Eau_Libre", "Algues", "Hydrophytes_NEnr", "Hydrophytes_Enr", "Helophytes"))
)
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
Vegetation = fct_relevel(as.factor(Vegetation), c("Helophytes", "Hydrophytes_Enr", "Hydrophytes_NEnr",
"Algues", "Eau_Libre", "Fond_Ex"))
rec2 <- rec %>%
gather(Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre,
key = "Vegetation",
value = "Couvrement")
rec2 <- rec2 %>%
mutate(
Vegetation = fct_relevel(as.factor(Vegetation), c("Helophytes", "Hydrophytes_Enr", "Hydrophytes_NEnr",
"Algues", "Eau_Libre", "Fond_Ex"))
)
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
rec2 <- rec %>%
gather(Helophytes,
Hydrophytes_Enr,
Hydrophytes_NEnr,
Algues,
Fond_Ex,
Eau_Libre,
key = "Vegetation",
value = "Recouvrement")
rec2 <- rec2 %>%
mutate(
Vegetation = fct_relevel(as.factor(Vegetation), c("Helophytes", "Hydrophytes_Enr", "Hydrophytes_NEnr",
"Algues", "Eau_Libre", "Fond_Ex"))
)
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Couvrement, fill = Vegetation), stat = "identity", position = "fill")
ggplot(rec2) + geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill")
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation")
Recouvrement
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation") +
theme(title = element_text(hjust = .5))
Recouvrement
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation") +
theme(plot.title = element_text(hjust = .5))
Recouvrement
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation") +
theme(plot.title = element_text(hjust = .5, size = 24))
Recouvrement
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Profondeur, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation") +
theme(plot.title = element_text(hjust = .5, size = 24))
Recouvrement
Recouvrement <- ggplot(rec2) +
geom_bar(aes(x = Evolution, y = Recouvrement, fill = Vegetation), stat = "identity", position = "fill") +
ggtitle("Recouvrement des mares selon le stade d'évolution et le type de Végétation") +
theme(plot.title = element_text(hjust = .5, size = 24))
Recouvrement
Prof <- ggplot(rec2) +
geom_point(aes(x = Profondeur, y = Recouvrement, col = Vegetation))
Prof
rec2
Prof <- ggplot(rec2) +
geom_line(aes(x = Profondeur, y = Recouvrement, col = Vegetation))
Prof
Prof <- ggplot(rec2, aes(x = Profondeur, y = Recouvrement, col = Vegetation)) +
geom_point() +
geom_smooth()
Prof
Prof <- ggplot(rec2, aes(x = Profondeur, y = Recouvrement, col = Vegetation)) +
geom_point() +
geom_smooth(se = F)
Prof
rec2
rec2$Profondeur
